(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6af8ec37"],{"307e":function(t){t.exports={type:"FeatureCollection",features:[{type:"Feature",properties:{stroke:"#555555","stroke-width":2,"stroke-opacity":1,fill:"#555555","fill-opacity":.5,name:"a1"},geometry:{type:"Polygon",coordinates:[[[113.31908226013184,23.129783597745387],[113.31951141357422,23.122916390445305],[113.32732200622559,23.122837454984705],[113.32852363586424,23.127020970404175],[113.31908226013184,23.129783597745387]]]}},{type:"Feature",properties:{stroke:"#555555","stroke-width":2,"stroke-opacity":1,fill:"#555555","fill-opacity":.5,name:"b1"},geometry:{type:"Polygon",coordinates:[[[113.3213996887207,23.106970484867855],[113.31418991088867,23.10247055501927],[113.31951141357422,23.09931261948516],[113.3243179321289,23.101523182154658],[113.3228588104248,23.10389160178689],[113.3213996887207,23.106970484867855]]]}},{type:"Feature",properties:{stroke:"#555555","stroke-width":2,"stroke-opacity":1,fill:"#555555","fill-opacity":.5,name:"a2"},geometry:{type:"Polygon",coordinates:[[[113.32818031311035,23.120864053378302],[113.32826614379883,23.11565413370351],[113.34611892700195,23.11344380365309],[113.34629058837889,23.119916810298935],[113.32818031311035,23.120864053378302]]]}},{type:"Feature",properties:{stroke:"#555555","stroke-width":2,"stroke-opacity":1,fill:"#555555","fill-opacity":.5,name:"b2"},geometry:{type:"Polygon",coordinates:[[[113.34611892700195,23.107523097435966],[113.34603309631348,23.101838973851994],[113.35049629211426,23.101444234114318],[113.35066795349121,23.106812595144962],[113.34611892700195,23.107523097435966]]]}}]}},"387c":function(t,e,s){},4391:function(t,e,s){"use strict";var i=s("ec45"),a=s.n(i);a.a},"489e":function(t,e,s){"use strict";var i=s("387c"),a=s.n(i);a.a},c54f:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("example",[s("xdh-map",{ref:"map",attrs:{zoom:12,center:[113.4,23.06]},on:{ready:t.mapReady,click:t.featureClickHandle}},[s("xdh-map-geo",{ref:"geo",attrs:{state:t.state,"draw-define":t.drawDefineFn}}),s("xdh-map-placement",{attrs:{placement:"left-top",margin:[10,10],theme:"light"}},[s("div",{staticStyle:{padding:"10px",cursor:"pointer"},on:{click:t.toEdit}},[t._v(t._s(t.editing?"保存编辑":"编辑"))])]),s("xdh-map-placement",{attrs:{placement:"right-top",margin:[10,10],theme:"light"}},[s("div",{staticStyle:{padding:"10px",cursor:"pointer"},on:{click:t.toAdd}},[t._v(t._s(t.adding?"保存添加":"添加"))])]),s("xdh-map-placement",{attrs:{placement:"left-bottom",margin:[10,10],theme:"light"}},[s("div",{staticStyle:{padding:"10px",cursor:"pointer"},on:{click:t.saveJson}},[t._v("导出")])]),s("xdh-map-placement",{attrs:{placement:"right-bottom",margin:[10,10],theme:"light"}},[s("div",{staticClass:"edit-btn-wrap clearfix"},[s("div",{staticClass:"edit-btn",attrs:{title:"添加"}},[s("span",{staticClass:"iconfont"},[t._v("")])]),s("div",{staticClass:"edit-btn",attrs:{title:"编辑"}},[s("span",{staticClass:"iconfont"},[t._v("")])]),s("div",{staticClass:"edit-btn",attrs:{title:"导出"}},[s("span",{staticClass:"iconfont"},[t._v("")])])])]),s("xdh-map-draw",{ref:"polygon",attrs:{type:"Polygon"},on:{drawstart:t.drawStartHandle,drawend:t.addDrawEnd}}),s("edit-popup",{attrs:{position:t.popupCenter,offset:[0,0],show:t.popupShow,target:t.editTarget},on:{"on-save":t.propertiesSaveHandle}})],1)],1)},a=[];const o=function(t){const e=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;let s=t.toLowerCase();if(s&&e.test(s)){if(4===s.length){let t="#";for(let e=1;e<4;e+=1)t+=s.slice(e,e+1).concat(s.slice(e,e+1));s=t}let t=[];for(let e=1;e<7;e+=2)t.push(parseInt("0x"+s.slice(e,e+2)));return"RGB("+t.join(",")+")"}return s};var r=s("307e"),d=s("3a0d"),l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("xdh-map-popup",{ref:"popup",attrs:{position:t.position,offset:t.offset,title:"属性编辑","close-on-click":!1,width:"300px"}},[s("div",{staticClass:"properties-table"},[s("div",{staticClass:"head row"},[s("div",{staticClass:"label"},[t._v("属性")]),s("div",{staticClass:"value"},[t._v("值")])]),s("div",{staticClass:"body"},[t._l(t.editProp,function(e,i){return s("div",{key:i,staticClass:"row"},[s("div",{staticClass:"label"},[t._v(t._s(i))]),s("div",{staticClass:"value"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.editKey!==i,expression:"editKey !== key"}],class:{show:!0,changed:e!==t.target.properties[i]},on:{click:function(e){return t.setEdit(i)}}},[t._v(t._s(e))]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.editKey===i,expression:"editKey === key"}],staticClass:"edit"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.editProp[i],expression:"editProp[key]"}],attrs:{type:"text"},domProps:{value:t.editProp[i]},on:{blur:function(e){t.editKey=""},input:function(e){e.target.composing||t.$set(t.editProp,i,e.target.value)}}})])])])}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isAdd,expression:"isAdd"}],staticClass:"row"},[s("div",{staticClass:"label"},[s("div",{staticClass:"edit"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.addItem["key"],expression:"addItem['key']"}],attrs:{type:"text"},domProps:{value:t.addItem["key"]},on:{blur:t.addItemBlur,input:function(e){e.target.composing||t.$set(t.addItem,"key",e.target.value)}}})])]),s("div",{staticClass:"value"},[s("div",{staticClass:"edit"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.addItem["value"],expression:"addItem['value']"}],attrs:{type:"text"},domProps:{value:t.addItem["value"]},on:{blur:t.addItemBlur,input:function(e){e.target.composing||t.$set(t.addItem,"value",e.target.value)}}})])])])],2)]),s("div",{staticClass:"btn-wrap"},[s("button",{staticClass:"add",on:{click:t.addHandle}},[t._v("添加")]),s("button",{staticClass:"save",on:{click:t.saveHandle}},[t._v("保存")])])])},n=[];const p=["stroke","stroke-width","stroke-opacity","fill","fill-opacity"];var c={name:"EditPopup",props:{position:{type:Array,default:()=>{return[0,0]}},offset:{type:Array,default:()=>{return[0,0]}},show:{type:Boolean,default:!1},target:{type:Object,default:()=>{return{geometry:null,properties:{}}}}},data(){return{editProp:Object.assign({},this.target.properties),editKey:"",addItem:{key:"",value:""},isAdd:!1}},computed:{},watch:{target(t){this.editProp=Object.assign({},t.properties)},show(t){t?this.$refs.popup.show():this.$refs.popup.hide()}},methods:{setEdit(t){p.find(e=>{return e===t})||(this.editKey=t)},addItemBlur(){this.addItem.key&&this.addItem.value&&(this.editProp[this.addItem.key]=this.addItem.value,this.addItem.key="",this.addItem.value="",this.isAdd=!1)},addHandle(){this.isAdd=!0},saveHandle(){this.$emit("on-save",{id:this.target.id,geometry:this.target.geometry,properties:this.editProp}),this.$refs.popup.hide()}},created(){},mounted(){this.show||this.$refs.popup.hide()},beforeDestroy(){}},u=c,h=(s("489e"),s("2877")),m=Object(h["a"])(u,l,n,!1,null,"38de254c",null),f=m.exports;const y=function(t){let e=o(t["fill"]),s=e.substring(0,e.length-1)+`,${t["fill-opacity"]})`,i=o(t["stroke"]),a=i.substring(0,i.length-1)+`,${t["stroke-opacity"]})`;return Object(d["b"])({className:"Style",fill:{className:"Fill",color:s},stroke:{className:"Stroke",color:a,width:t["stroke-width"]}})};var v={components:{EditPopup:f},data(){return{map:null,state:r,editing:!1,editPol:[],adding:!1,popupCenter:[0,0],popupShow:!1,editTarget:{geometry:null,properties:{}}}},methods:{toEdit(){this.adding=!1,this.$refs.polygon.finish(),this.editing?(this.$refs.polygon.finish(),this.saveEdit(this.editPol)):this.$refs.polygon.modify(),this.editing=!this.editing},saveEdit(t){let e=this.state.features;t.forEach((t,s)=>{let i=t.getGeometry().getCoordinates(),a=e[s].geometry;a.coordinates=i})},toAdd(){this.editing=!1,this.$refs.polygon.finish(),this.saveEdit(this.editPol),this.adding?this.$refs.polygon.finish():this.$refs.polygon.draw(),this.adding=!this.adding},saveJson(){console.log(JSON.stringify(this.state))},drawStartHandle(t){console.log(t)},addDrawEnd(t){this.editPol.push(t.feature),this.state.features.push({type:"Feature",properties:{stroke:"#555555","stroke-width":2,"stroke-opacity":1,fill:"#555555","fill-opacity":.5},geometry:{type:"Polygon",coordinates:t.feature.getGeometry().getCoordinates()}})},featureClickHandle(t){const e=this.$refs.map.getFeatureAtPixel(t.pixel);e&&(this.popupShow=!0,this.popupCenter=e.getGeometry().getInteriorPoint().getCoordinates(),this.editTarget=e.getProperties())},propertiesSaveHandle(t){let e=this.editPol.findIndex(e=>{return e.ol_uid===t.id});this.editPol[e].set("properties",t.properties),this.state.features[e].properties=t.properties},setActiveStyle(t){return Object(d["b"])({className:"Style",fill:{className:"Fill",color:"pink"},stroke:{className:"Stroke",color:"yellow",width:2},text:{className:"Text",text:t.properties.name,font:"14px sans-serif",fill:{className:"Fill",color:"blue"}}})},drawDefineFn(t,e){let s=t.clone();s.set("properties",e.properties),s.set("id",s.ol_uid),s.setStyle(y(e.properties)),this.$refs.map.addFeature(s),this.$refs.polygon.addFeatures([s]),this.editPol.push(s),t.setStyle(Object(d["b"])({className:"Style",fill:{className:"Fill",color:"transparent"},stroke:{className:"Stroke",color:"transparent",width:1}}))},mapReady(t,e){this.map=t}},mounted(){}},g=v,w=(s("4391"),Object(h["a"])(g,i,a,!1,null,"520925ca",null));e["default"]=w.exports},ec45:function(t,e,s){}}]);
//# sourceMappingURL=chunk-6af8ec37.6ec70c30.js.map